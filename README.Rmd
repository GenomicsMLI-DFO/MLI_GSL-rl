---
title: "GSL-rl : Gulf of St. Lawrence reference library"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Library

library(tidyverse)

# Read the dataset

metadata   <- readr::read_csv2("GSL-rl_COI/GSL-rl_COI_metadata2.csv")
DNA.leray  <- Biostrings::readDNAStringSet("GSL-rl_COI/GSL-rl_COI_Leray313pb_450taxa_1040seq.fasta")
DNA.folmer <- Biostrings::readDNAStringSet("GSL-rl_COI/GSL-rl_COI_Folmer650pb_450taxa_1304seq.fasta")


#

colorBlindBlack8  <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
                       "#F0E442", "#0072B2", "#D55E00", "#CC79A7")



```

Reference sequences for metabarcording species assignments in the Gulf of St. Lawrence

__Main maintainer:__  Audrey Bourret  
__Affiliation:__  Fisheries and Oceans Canada (DFO)   
__Group:__        Laboratory of genomics   
__Location:__     Maurice Lamontagne Institute  
__Affiliated publication:__  Maximizing the reliability and the number of species assignments in metabarcoding studies (in prepatation). Bourret, A., Nozères, C., Parent, É., Parent, G.J.  
__Contact:__      audrey.bourret@dfo-mpo.gc.ca

- [Description of GSL-rl](#description-of-gsl-rl)
- [Status](#status)
- [Contents](#contents)
  + [Subsections within contents](#subsections-within-contents)
- [Requirements](#requirements)
- [Caveats](#caveats)
- [Uncertainty](#uncertainty)
- [Acknowledgements](#acknowledgements)
- [References](#references)


## Description of GSL-rl

GSL-rl is a collection of curated and annotated sequences for performing genetic assignments using COI barcodes for marine fauna in the Gulf of St. Lawrence. It actually covered `r metadata %>% dplyr::filter(WithinNWA == "Yes", Level == "Species") %>%  nrow()` targeted species, and sequences are currently available for **`r metadata %>% dplyr::filter(WithinNWA == "Yes", Level == "Species", Validity != "No sequences available") %>%  nrow()` species**.

```{r echo=FALSE, message=FALSE, warning=FALSE}
metadata %>% dplyr::filter(WithinNWA == "Yes", Level == "Species") %>%  
  mutate( Validity = factor(Validity, levels = c("Reliable",  "Unreliable - BIN sharing","Unreliable - gaps", "No sequences available"))) %>% 
                         group_by(phylum, Validity) %>% 
  summarise(N = n()) %>% 
  mutate(SUM = sum(N),
       freq = N / sum(N)) %>% 
  ggplot(aes(x = 1, y = freq, fill = Validity)) +
  geom_bar(width = , stat = "identity", color = "gray10", cex = 0.2) +
  coord_polar("y", start = 0) + 
  scale_fill_manual(name = "Species detection category", 
                    values = c(colorBlindBlack8[4], colorBlindBlack8[5], colorBlindBlack8[2],"gray"))+

  geom_text(aes(y = 0.1, label = paste0("n=",SUM)), vjust = 4, col = "black", cex = 3) +
  facet_wrap(~phylum, nrow = 2) + theme_void() +
  theme(legend.title = element_blank(),
        legend.position = "bottom",
        plot.background = element_rect(fill = "white", colour = NA),
        plot.margin = margin(t = 20, r = 10, b = 10, l = 10, unit = "pt"))
  
```


## Status
"Ongoing-improvements"

## Contents
Describe the contents of the repository. Are there multiple scripts or directories? What are their purpose and how do they relate to each other?
### Subsections within contents
Use subsections to describe the purpose of each script if warranted.



```{r eval=FALSE, include=FALSE}

DNA.folmer.cor <- DNA.folmer %>% stringr::str_remove_all("-") %>% Biostrings::DNAStringSet()

summary(DNA.folmer.cor@ranges@width)


stringr::str_count(DNA.folmer.cor, "N") %>% summary()


summary(stringr::str_count(DNA.folmer.cor, "N") /DNA.folmer.cor@ranges@width * 100)


sd(stringr::str_count(DNA.folmer.cor, "N") /DNA.folmer.cor@ranges@width * 100
   )
```


## Requirements
*Optional section.* List the input data requirements or software requirements to successfully execute the code.


## Caveats
Anything other users should be aware of including gaps in the input or output data and warnings about appropriate use.


## Uncertainty
*Optional section.* Is there some uncertainty associated with the output? Assumptions that were made?


## Acknowledgements
*Optional section.* List any contributors and acknowledge relevant people or institutions


## References
*Optional section.*
